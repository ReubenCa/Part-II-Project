let rec collatz = fun n ->
  if (==) n 1 then 1 else
  if (mod) n 2 == 0 then 
      (+) 1 (collatz ((/) n 2))
  else
      (+) 1 (collatz ((+) (( *) n 3) 1))
in collatz